CREATE PROCEDURE AddItem (@name varchar(50), @cat int, @price money, @stock smallint)
as
begin 
Insert into Product(ProductName,CategoryID, UnitPrice, UnitsInstock) values(@name, @cat, @price, @stock);
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE AddLog(@name varchar(200),@trace varchar(200),@message varchar(200))
as
begin
Insert into ExceptionLog(Function_Name,Stack_Trace,Ex_Message) values(@name,@trace,@message)
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE CatChildren (@id int)
as
begin
Select ProductID,ProductName from Product where CategoryID=@id
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE Cats
as
begin
Select distinct CategoryID from Product
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE DataCount as
begin
Select count(ProductID) from Product
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE DeleteItem(@id int)
as
begin
Delete from Product where ProductID=@id;
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE FindItem (@ColumnName varchar(50), @Key varchar(50))
as
begin
Select ProductID,ProductName,CategoryID ,UnitPrice,UnitsInstock from Product where @ColumnName like @Key
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE getdata(@id int, @firstname varchar(50) output, @lastname varchar(50) output, @city varchar(50) output)
as
begin
Select @firstname=first_name, @lastname=last_name, @city=location from datatable where Id = @id;
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE GetElement(@id int)
as
begin
SELECT ProductID,ProductName,CategoryID,UnitPrice,UnitsInstock from Product where ProductID=@id;
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE GetItems (@start int, @end int)
as 
begin
with Temp as (Select ROW_NUMBER() over (order by ProductID asc) as "RowNumber", ProductID,ProductName,CategoryID,UnitPrice,UnitsInstock from Product)
Select ProductID,ProductName,CategoryID,UnitPrice,UnitsInstock From Temp where RowNumber between @start and @end
end
--------------------------------------------------------------------------------------------------------------------
CREATE PROCEDURE UpdateItem( @name varchar(50), @category int, @uprice money, @ustock smallint,@id int )
as
begin
Update Product set ProductName=@name,CategoryID=@category,UnitPrice=@uprice,UnitsInstock=@ustock where ProductID=@id
end
--------------------------------------------------------------------------------------------------------------------